<div class="error-page-container">
  <nav class="error-breadcrumbs">
    <ol class="breadcrumbs">
      <li class="breadcrumbs-item">
        <a href="{{help_center.url}}">{{help_center.name}}</a>
      </li>
    </ol>
  </nav>

  <main class="error-main">
    <div class="error-content">
      <div class="error-icon">
        {{#is status_code 404}}
          <span class="error-emoji">ğŸ”</span>
        {{else}}
          {{#is status_code 403}}
            <span class="error-emoji">ğŸ”’</span>
          {{else}}
            {{#is status_code 500}}
              <span class="error-emoji">âš ï¸</span>
            {{else}}
              <span class="error-emoji">âŒ</span>
            {{/is}}
          {{/is}}
        {{/is}}
      </div>

      <h1 class="error-title">
        {{#is status_code 404}}
          ãƒšãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“
        {{else}}
          {{#is status_code 403}}
            ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“
          {{else}}
            {{#is status_code 500}}
              ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ
            {{else}}
              ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ
            {{/is}}
          {{/is}}
        {{/is}}
      </h1>

      <div class="error-description">
        {{#is status_code 404}}
          <p>ãŠæ¢ã—ã®ãƒšãƒ¼ã‚¸ã¯å­˜åœ¨ã—ãªã„ã‹ã€ç§»å‹•ã¾ãŸã¯å‰Šé™¤ã•ã‚ŒãŸå¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</p>
        {{else}}
          {{#is status_code 403}}
            <p>ã“ã®ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ãªå ´åˆãŒã‚ã‚Šã¾ã™ã€‚</p>
          {{else}}
            {{#is status_code 500}}
              <p>ä¸€æ™‚çš„ãªã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã—ã°ã‚‰ãæ™‚é–“ã‚’ãŠã„ã¦ã‹ã‚‰å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚</p>
            {{else}}
              <p>äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ãŠæ‰‹æ•°ã§ã™ãŒã€å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚</p>
            {{/is}}
          {{/is}}
        {{/is}}
      </div>

      {{#if error_message}}
      <div class="error-details">
        <details class="error-details-expandable">
          <summary class="error-details-summary">ã‚¨ãƒ©ãƒ¼ã®è©³ç´°</summary>
          <div class="error-details-content">
            <p>{{error_message}}</p>
            {{#if status_code}}
            <p><strong>ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰:</strong> {{status_code}}</p>
            {{/if}}
          </div>
        </details>
      </div>
      {{/if}}

      <div class="error-actions">
        {{#is status_code 404}}
          <a href="{{help_center.url}}" class="btn btn-primary error-home">
            ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹
          </a>
          <button class="btn btn-secondary error-back" onclick="history.back()">
            å‰ã®ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹
          </button>
          <a href="{{help_center.url}}/hc/{{locale}}/search" class="btn btn-secondary error-search">
            æ¤œç´¢ã§æ¢ã™
          </a>
        {{else}}
          {{#is status_code 403}}
            <a href="{{help_center.signin_url}}" class="btn btn-primary error-signin">
              ã‚µã‚¤ãƒ³ã‚¤ãƒ³
            </a>
            <a href="{{help_center.url}}" class="btn btn-secondary error-home">
              ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹
            </a>
            <button class="btn btn-secondary error-back" onclick="history.back()">
              å‰ã®ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹
            </button>
          {{else}}
            <button class="btn btn-primary error-retry" onclick="location.reload()">
              å†èª­ã¿è¾¼ã¿
            </button>
            <a href="{{help_center.url}}" class="btn btn-secondary error-home">
              ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹
            </a>
            <button class="btn btn-secondary error-back" onclick="history.back()">
              å‰ã®ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹
            </button>
          {{/is}}
        {{/is}}
      </div>

      {{#is status_code 404}}
      <div class="error-suggestions">
        <h3>ãŠæ¢ã—ã®ã‚‚ã®ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ï¼š</h3>
        <ul class="suggestions-list">
          <li>URLã®ã‚¹ãƒšãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„</li>
          <li>æ¤œç´¢æ©Ÿèƒ½ã‚’ä½¿ã£ã¦ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æ¢ã—ã¦ãã ã•ã„</li>
          <li>ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ç›®çš„ã®ãƒšãƒ¼ã‚¸ã«ç§»å‹•ã—ã¦ãã ã•ã„</li>
          <li>å•é¡ŒãŒç¶šãå ´åˆã¯ã€ã‚µãƒãƒ¼ãƒˆã«ãŠå•ã„åˆã‚ã›ãã ã•ã„</li>
        </ul>
      </div>
      {{/is}}

      {{#unless status_code}}
        {{#unless status_code}}
        <div class="error-suggestions">
          <h3>å•é¡Œè§£æ±ºã®ãƒ’ãƒ³ãƒˆï¼š</h3>
          <ul class="suggestions-list">
            <li>ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„</li>
            <li>ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„</li>
            <li>ã—ã°ã‚‰ãæ™‚é–“ã‚’ãŠã„ã¦ã‹ã‚‰å†åº¦ãŠè©¦ã—ãã ã•ã„</li>
            <li>å•é¡ŒãŒç¶šãå ´åˆã¯ã€ã‚µãƒãƒ¼ãƒˆã«ãŠå•ã„åˆã‚ã›ãã ã•ã„</li>
          </ul>
        </div>
        {{/unless}}
      {{/unless}}
    </div>
  </main>

  <aside class="error-sidebar">
    <div class="error-help">
      <h3>ã‚µãƒãƒ¼ãƒˆãŒå¿…è¦ã§ã™ã‹ï¼Ÿ</h3>
      <p>å•é¡ŒãŒè§£æ±ºã—ãªã„å ´åˆã¯ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚</p>
      <div class="error-help-actions">
        {{#if help_center.contact_us_url}}
        <a href="{{help_center.contact_us_url}}" class="btn btn-primary error-contact">
          ãŠå•ã„åˆã‚ã›
        </a>
        {{/if}}
        <a href="{{help_center.url}}/requests/new" class="btn btn-secondary error-request">
          ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡
        </a>
      </div>
    </div>

    {{#if popular_articles}}
    <div class="error-popular">
      <h3>äººæ°—ã®è¨˜äº‹</h3>
      <ul class="popular-articles-list">
        {{#each popular_articles}}
        <li class="popular-article-item">
          <a href="{{url}}" class="popular-article-link">{{title}}</a>
        </li>
        {{/each}}
      </ul>
    </div>
    {{/if}}

    <div class="error-quick-links">
      <h3>ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ³ã‚¯</h3>
      <ul class="quick-links-list">
        <li><a href="{{help_center.url}}">ãƒ˜ãƒ«ãƒ—ã‚»ãƒ³ã‚¿ãƒ¼</a></li>
        <li><a href="{{help_center.url}}/hc/{{locale}}/search">æ¤œç´¢</a></li>
        {{#if community.url}}
        <li><a href="{{community.url}}">ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£</a></li>
        {{/if}}
        <li><a href="{{help_center.url}}/requests">ãƒªã‚¯ã‚¨ã‚¹ãƒˆå±¥æ­´</a></li>
      </ul>
    </div>

    <div class="error-status">
      <h3>ã‚µãƒ¼ãƒ“ã‚¹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</h3>
      <p>ç¾åœ¨ã®ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ³ã‚’ç¢ºèªã§ãã¾ã™ã€‚</p>
      {{#if status_page_url}}
      <a href="{{status_page_url}}" target="_blank" class="btn btn-secondary error-status-link">
        ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒšãƒ¼ã‚¸
      </a>
      {{else}}
      <div class="service-status">
        <div class="status-indicator status-indicator--operational">
          <span class="status-dot"></span>
          <span class="status-text">æ­£å¸¸ç¨¼åƒä¸­</span>
        </div>
      </div>
      {{/if}}
    </div>
  </aside>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Error tracking
  if (window.location.search.includes('track_error=true')) {
    // Track error for analytics (if available)
    if (typeof gtag !== 'undefined') {
      gtag('event', 'exception', {
        'description': '{{status_code}} - {{error_message}}',
        'fatal': false
      });
    }
  }
  
  // Auto-retry for 5xx errors after delay
  {{#if status_code}}
  {{#gte status_code 500}}
  setTimeout(function() {
    var retryBtn = document.querySelector('.error-retry');
    if (retryBtn && !retryBtn.dataset.autoRetried) {
      retryBtn.dataset.autoRetried = 'true';
      retryBtn.textContent = 'è‡ªå‹•å†èª­ã¿è¾¼ã¿ä¸­...';
      setTimeout(function() {
        location.reload();
      }, 1000);
    }
  }, 5000);
  {{/gte}}
  {{/if}}
});
</script>