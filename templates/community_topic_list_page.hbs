<div class="community-topics-container">
  <nav class="topics-breadcrumbs">
    <ol class="breadcrumbs">
      <li class="breadcrumbs-item">
        <a href="{{help_center.url}}">{{help_center.name}}</a>
      </li>
      <li class="breadcrumbs-item">
        <a href="{{community.url}}">ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£</a>
      </li>
    </ol>
  </nav>

  <header class="topics-header">
    <div class="topics-header-content">
      <h1 class="topics-title">ãƒˆãƒ”ãƒƒã‚¯ä¸€è¦§</h1>
      <div class="topics-description">
        <p>èˆˆå‘³ã®ã‚ã‚‹ãƒˆãƒ”ãƒƒã‚¯ã‚’é¸æŠã—ã¦ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã«å‚åŠ ã—ã¾ã—ã‚‡ã†ã€‚</p>
      </div>
    </div>
    
    <div class="topics-actions">
      {{#if current_user}}
      {{#if current_user.agent}}
      <a href="{{community.url}}/topics/new" class="btn btn-primary topics-new-topic">
        æ–°ã—ã„ãƒˆãƒ”ãƒƒã‚¯ã‚’ä½œæˆ
      </a>
      {{/if}}
      {{/if}}
    </div>
  </header>

  <main class="topics-main">
    {{#if topics}}
    <div class="topics-content">
      <div class="topics-header-bar">
        <div class="topics-count">
          {{topics.length}} å€‹ã®ãƒˆãƒ”ãƒƒã‚¯
        </div>
        
        <div class="topics-sorting">
          <label for="topics-sort-select">ä¸¦ã³æ›¿ãˆ:</label>
          <select id="topics-sort-select" class="topics-sort-select">
            <option value="activity">æœ€æ–°æ´»å‹•é †</option>
            <option value="posts">æŠ•ç¨¿æ•°é †</option>
            <option value="name">åå‰é †</option>
            <option value="created">ä½œæˆæ—¥é †</option>
          </select>
        </div>
      </div>

      <div class="topics-grid">
        {{#each topics}}
        <article class="topic-card">
          <a href="{{url}}" class="topic-card-link">
            <header class="topic-card-header">
              <h3 class="topic-card-title">{{name}}</h3>
              {{#if description}}
              <div class="topic-card-description">
                <p>{{excerpt description characters=120}}</p>
              </div>
              {{/if}}
            </header>
            
            <div class="topic-card-stats">
              <div class="topic-stat">
                <span class="topic-stat-number">{{post_count}}</span>
                <span class="topic-stat-label">æŠ•ç¨¿</span>
              </div>
              
              <div class="topic-stat">
                <span class="topic-stat-number">{{follower_count}}</span>
                <span class="topic-stat-label">ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼</span>
              </div>
            </div>
            
            {{#if latest_post}}
            <div class="topic-card-latest">
              <div class="topic-latest-info">
                <span class="topic-latest-label">æœ€æ–°:</span>
                <time class="topic-latest-date" datetime="{{latest_post.created_at}}">
                  {{date latest_post.created_at timeago=true}}
                </time>
              </div>
              {{#if latest_post.author}}
              <div class="topic-latest-author">
                {{#if latest_post.author.avatar_url}}
                <img src="{{latest_post.author.avatar_url}}" alt="{{latest_post.author.name}}" class="topic-latest-avatar" loading="lazy">
                {{/if}}
                <span class="topic-latest-name">{{latest_post.author.name}}</span>
              </div>
              {{/if}}
            </div>
            {{/if}}
          </a>
          
          <footer class="topic-card-footer">
            {{#if current_user}}
            <div class="topic-card-actions">
              <button class="topic-follow-btn {{#if following}}topic-follow-btn--active{{/if}}" 
                      data-topic-id="{{id}}">
                {{#if following}}
                  <span class="topic-follow-icon">âœ“</span>
                  <span class="topic-follow-text">ãƒ•ã‚©ãƒ­ãƒ¼ä¸­</span>
                {{else}}
                  <span class="topic-follow-icon">+</span>
                  <span class="topic-follow-text">ãƒ•ã‚©ãƒ­ãƒ¼</span>
                {{/if}}
              </button>
            </div>
            {{/if}}
          </footer>
        </article>
        {{/each}}
      </div>
      
      <!-- Pagination -->
      {{pagination}}
    </div>
    
    {{else}}
    <div class="topics-empty">
      <div class="empty-state">
        <div class="empty-state-icon">ğŸ’¬</div>
        <h2 class="empty-state-title">ãƒˆãƒ”ãƒƒã‚¯ãŒã‚ã‚Šã¾ã›ã‚“</h2>
        <div class="empty-state-description">
          <p>ã¾ã ãƒˆãƒ”ãƒƒã‚¯ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚æœ€åˆã®ãƒˆãƒ”ãƒƒã‚¯ã‚’ä½œæˆã—ã¦ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã‚’å§‹ã‚ã¾ã—ã‚‡ã†ã€‚</p>
        </div>
        
        <div class="empty-state-actions">
          {{#if current_user}}
          {{#if current_user.agent}}
          <a href="{{community.url}}/topics/new" class="btn btn-primary">
            æœ€åˆã®ãƒˆãƒ”ãƒƒã‚¯ã‚’ä½œæˆ
          </a>
          {{/if}}
          {{else}}
          <a href="{{help_center.signin_url}}" class="btn btn-secondary">
            ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã—ã¦ãƒˆãƒ”ãƒƒã‚¯ã‚’è¡¨ç¤º
          </a>
          {{/if}}
          <a href="{{help_center.url}}" class="btn btn-secondary">
            ãƒ˜ãƒ«ãƒ—ã‚»ãƒ³ã‚¿ãƒ¼ã«æˆ»ã‚‹
          </a>
        </div>
      </div>
    </div>
    {{/if}}
  </main>

  <aside class="topics-sidebar">
    <div class="topics-overview">
      <h3>ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£çµ±è¨ˆ</h3>
      <div class="community-stats">
        {{#if community.stats}}
        <div class="community-stat-item">
          <span class="community-stat-number">{{community.stats.total_posts}}</span>
          <span class="community-stat-label">ç·æŠ•ç¨¿æ•°</span>
        </div>
        
        <div class="community-stat-item">
          <span class="community-stat-number">{{community.stats.total_users}}</span>
          <span class="community-stat-label">å‚åŠ è€…</span>
        </div>
        
        <div class="community-stat-item">
          <span class="community-stat-number">{{community.stats.active_topics}}</span>
          <span class="community-stat-label">ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒˆãƒ”ãƒƒã‚¯</span>
        </div>
        {{/if}}
      </div>
    </div>

    {{#if popular_topics}}
    <div class="popular-topics">
      <h3>äººæ°—ã®ãƒˆãƒ”ãƒƒã‚¯</h3>
      <ul class="popular-topics-list">
        {{#each popular_topics}}
        <li class="popular-topic-item">
          <a href="{{url}}" class="popular-topic-link">
            <span class="popular-topic-name">{{name}}</span>
            <span class="popular-topic-count">{{post_count}} æŠ•ç¨¿</span>
          </a>
        </li>
        {{/each}}
      </ul>
    </div>
    {{/if}}

    {{#if recent_activity}}
    <div class="recent-activity">
      <h3>æœ€æ–°ã®æ´»å‹•</h3>
      <ul class="recent-activity-list">
        {{#each recent_activity}}
        <li class="recent-activity-item">
          <div class="recent-activity-content">
            <a href="{{post.url}}" class="recent-activity-link">
              {{post.title}}
            </a>
            <div class="recent-activity-meta">
              <span class="recent-activity-author">{{post.author.name}}</span>
              <time class="recent-activity-date" datetime="{{post.created_at}}">
                {{date post.created_at timeago=true}}
              </time>
            </div>
          </div>
        </li>
        {{/each}}
      </ul>
    </div>
    {{/if}}

    <div class="community-guidelines-summary">
      <h3>ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³</h3>
      <ul class="guidelines-summary-list">
        <li>å»ºè¨­çš„ã§æ•¬æ„ã®ã‚ã‚‹ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã‚’</li>
        <li>é–¢é€£ã™ã‚‹ãƒˆãƒ”ãƒƒã‚¯ã«æŠ•ç¨¿ã—ã¾ã—ã‚‡ã†</li>
        <li>ã‚¹ãƒ‘ãƒ ã‚„é‡è¤‡æŠ•ç¨¿ã¯é¿ã‘ã¾ã—ã‚‡ã†</li>
      </ul>
      <a href="{{community.url}}/guidelines" class="guidelines-link">
        è©³ç´°ãªã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’è¦‹ã‚‹
      </a>
    </div>
  </aside>
</div>