{{#with topic}}
<div class="topic-page-container">
  <nav class="topic-breadcrumbs">
    <ol class="breadcrumbs">
      <li class="breadcrumbs-item">
        <a href="{{help_center.url}}">{{help_center.name}}</a>
      </li>
      <li class="breadcrumbs-item">
        <a href="{{community.url}}">ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£</a>
      </li>
      <li class="breadcrumbs-item">
        <a href="{{community.url}}/topics">ãƒˆãƒ”ãƒƒã‚¯</a>
      </li>
    </ol>
  </nav>

  <header class="topic-page-header">
    <div class="topic-header-content">
      <h1 class="topic-page-title">{{name}}</h1>
      {{#if description}}
      <div class="topic-page-description">
        <p>{{description}}</p>
      </div>
      {{/if}}
      
      <div class="topic-meta">
        <div class="topic-stats">
          <div class="topic-stat-item">
            <span class="topic-stat-number">{{post_count}}</span>
            <span class="topic-stat-label">æŠ•ç¨¿</span>
          </div>
          <div class="topic-stat-item">
            <span class="topic-stat-number">{{follower_count}}</span>
            <span class="topic-stat-label">ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼</span>
          </div>
          {{#if created_at}}
          <div class="topic-created">
            <span class="topic-created-label">ä½œæˆæ—¥:</span>
            <time class="topic-created-date" datetime="{{created_at}}">
              {{date created_at}}
            </time>
          </div>
          {{/if}}
        </div>
      </div>
    </div>
    
    <div class="topic-actions">
      {{#if current_user}}
      <button class="topic-follow-btn {{#if following}}topic-follow-btn--active{{/if}}" 
              data-topic-id="{{id}}">
        {{#if following}}
          <span class="topic-follow-icon">âœ“</span>
          <span class="topic-follow-text">ãƒ•ã‚©ãƒ­ãƒ¼ä¸­</span>
        {{else}}
          <span class="topic-follow-icon">+</span>
          <span class="topic-follow-text">ãƒ•ã‚©ãƒ­ãƒ¼</span>
        {{/if}}
      </button>
      <a href="{{community.url}}/posts/new?topic_id={{id}}" class="btn btn-primary topic-new-post">
        æŠ•ç¨¿ã™ã‚‹
      </a>
      {{#if current_user.agent}}
      <div class="topic-admin-actions">
        <button class="btn btn-secondary topic-edit" data-topic-id="{{id}}">
          ç·¨é›†
        </button>
        {{#if pinned}}
        <button class="btn btn-secondary topic-unpin" data-topic-id="{{id}}">
          ãƒ”ãƒ³è§£é™¤
        </button>
        {{else}}
        <button class="btn btn-secondary topic-pin" data-topic-id="{{id}}">
          ãƒ”ãƒ³ç•™ã‚
        </button>
        {{/if}}
      </div>
      {{/if}}
      {{else}}
      <a href="{{help_center.signin_url}}" class="btn btn-secondary">
        ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã—ã¦å‚åŠ 
      </a>
      {{/if}}
    </div>
  </header>

  <main class="topic-main">
    {{#if posts}}
    <div class="topic-posts">
      <div class="posts-header">
        <div class="posts-count">
          {{posts.length}} ä»¶ã®æŠ•ç¨¿
        </div>
        
        <div class="posts-sorting">
          <label for="posts-sort-select">ä¸¦ã³æ›¿ãˆ:</label>
          <select id="posts-sort-select" class="posts-sort-select">
            <option value="recent">æœ€æ–°é †</option>
            <option value="popular">äººæ°—é †</option>
            <option value="oldest">å¤ã„é †</option>
            <option value="answered">å›ç­”æ¸ˆã¿</option>
          </select>
        </div>
      </div>

      <div class="posts-list-container">
        <ul class="posts-list">
          {{#each posts}}
          <li class="post-item">
            <article class="topic-post">
              <div class="post-stats">
                <div class="post-vote-count">
                  <span class="vote-count">{{vote_sum}}</span>
                  <span class="vote-label">æŠ•ç¥¨</span>
                </div>
                
                <div class="post-comment-count">
                  <span class="comment-count">{{comment_count}}</span>
                  <span class="comment-label">ã‚³ãƒ¡ãƒ³ãƒˆ</span>
                </div>
                
                {{#if status}}
                <div class="post-status post-status--{{status}}">
                  {{#is status 'solved'}}
                    <span class="post-status-icon">âœ…</span>
                    <span class="post-status-text">è§£æ±º</span>
                  {{/is}}
                  {{#is status 'answered'}}
                    <span class="post-status-icon">ğŸ’¬</span>
                    <span class="post-status-text">å›ç­”</span>
                  {{/is}}
                </div>
                {{/if}}
              </div>

              <div class="post-content">
                <h3 class="post-title">
                  <a href="{{url}}" class="post-link">{{title}}</a>
                </h3>
                
                {{#if details}}
                <div class="post-excerpt">
                  <p>{{excerpt details characters=200}}</p>
                </div>
                {{/if}}
                
                <div class="post-meta">
                  <div class="post-author">
                    {{#if author.avatar_url}}
                    <img src="{{author.avatar_url}}" alt="{{author.name}}" class="post-author-avatar" loading="lazy">
                    {{/if}}
                    <span class="post-author-name">{{author.name}}</span>
                  </div>
                  
                  <div class="post-dates">
                    <time class="post-created" datetime="{{created_at}}">
                      {{date created_at timeago=true}}
                    </time>
                    
                    {{#if last_activity_at}}
                    <time class="post-activity" datetime="{{last_activity_at}}">
                      æœ€çµ‚æ´»å‹•: {{date last_activity_at timeago=true}}
                    </time>
                    {{/if}}
                  </div>
                  
                  {{#if labels}}
                  <div class="post-labels">
                    {{#each labels}}
                    <span class="post-label">{{name}}</span>
                    {{/each}}
                  </div>
                  {{/if}}
                </div>
              </div>
            </article>
          </li>
          {{/each}}
        </ul>
        
        <!-- Pagination -->
        {{pagination}}
      </div>
    </div>
    
    {{else}}
    <div class="topic-empty">
      <div class="empty-state">
        <div class="empty-state-icon">ğŸ’¬</div>
        <h2 class="empty-state-title">ã¾ã æŠ•ç¨¿ãŒã‚ã‚Šã¾ã›ã‚“</h2>
        <div class="empty-state-description">
          <p>ã€Œ{{name}}ã€ã«ã¯ã¾ã æŠ•ç¨¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚æœ€åˆã®æŠ•ç¨¿ã‚’ã—ã¦ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã‚’å§‹ã‚ã¾ã—ã‚‡ã†ã€‚</p>
        </div>
        
        <div class="empty-state-actions">
          {{#if current_user}}
          <a href="{{community.url}}/posts/new?topic_id={{id}}" class="btn btn-primary">
            æœ€åˆã®æŠ•ç¨¿ã‚’ã™ã‚‹
          </a>
          {{else}}
          <a href="{{help_center.signin_url}}" class="btn btn-secondary">
            ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã—ã¦æŠ•ç¨¿
          </a>
          {{/if}}
          <a href="{{community.url}}/topics" class="btn btn-secondary">
            ä»–ã®ãƒˆãƒ”ãƒƒã‚¯ã‚’è¦‹ã‚‹
          </a>
        </div>
      </div>
    </div>
    {{/if}}
  </main>

  <aside class="topic-sidebar">
    {{#if moderators}}
    <div class="topic-moderators">
      <h3>ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚¿ãƒ¼</h3>
      <ul class="moderators-list">
        {{#each moderators}}
        <li class="moderator-item">
          <div class="moderator-info">
            {{#if avatar_url}}
            <img src="{{avatar_url}}" alt="{{name}}" class="moderator-avatar" loading="lazy">
            {{/if}}
            <span class="moderator-name">{{name}}</span>
          </div>
        </li>
        {{/each}}
      </ul>
    </div>
    {{/if}}

    {{#if related_topics}}
    <div class="related-topics">
      <h3>é–¢é€£ãƒˆãƒ”ãƒƒã‚¯</h3>
      <ul class="related-topics-list">
        {{#each related_topics}}
        <li class="related-topic-item">
          <a href="{{url}}" class="related-topic-link">
            <span class="related-topic-name">{{name}}</span>
            <div class="related-topic-stats">
              <span class="related-topic-posts">{{post_count}} æŠ•ç¨¿</span>
              <span class="related-topic-followers">{{follower_count}} ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼</span>
            </div>
          </a>
        </li>
        {{/each}}
      </ul>
    </div>
    {{/if}}

    {{#if recent_followers}}
    <div class="recent-followers">
      <h3>æœ€è¿‘ã®ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼</h3>
      <ul class="followers-list">
        {{#each recent_followers}}
        <li class="follower-item">
          <div class="follower-info">
            {{#if avatar_url}}
            <img src="{{avatar_url}}" alt="{{name}}" class="follower-avatar" loading="lazy">
            {{/if}}
            <span class="follower-name">{{name}}</span>
          </div>
          <time class="follower-date" datetime="{{followed_at}}">
            {{date followed_at timeago=true}}
          </time>
        </li>
        {{/each}}
      </ul>
    </div>
    {{/if}}

    <div class="topic-guidelines">
      <h3>æŠ•ç¨¿ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³</h3>
      <ul class="topic-guidelines-list">
        <li>ãƒˆãƒ”ãƒƒã‚¯ã«é–¢é€£ã™ã‚‹å†…å®¹ã‚’æŠ•ç¨¿ã—ã¾ã—ã‚‡ã†</li>
        <li>ä»–ã®å‚åŠ è€…ã‚’å°Šé‡ã—ã¾ã—ã‚‡ã†</li>
        <li>é‡è¤‡ã™ã‚‹è³ªå•ãŒãªã„ã‹ç¢ºèªã—ã¾ã—ã‚‡ã†</li>
        <li>æ˜ç¢ºã§åˆ†ã‹ã‚Šã‚„ã™ã„ã‚¿ã‚¤ãƒˆãƒ«ã‚’ä»˜ã‘ã¾ã—ã‚‡ã†</li>
      </ul>
    </div>

    <div class="topic-navigation">
      <a href="{{community.url}}/topics" class="btn btn-secondary topic-back">
        ãƒˆãƒ”ãƒƒã‚¯ä¸€è¦§ã«æˆ»ã‚‹
      </a>
    </div>
  </aside>
</div>
{{/with}}